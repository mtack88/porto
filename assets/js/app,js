// JS globale (Vanilla)
(function(){
  // CSRF helper: legge dal meta
  window.getCsrfToken = function(){
    const meta = document.querySelector('meta[name="csrf-token"]');
    return meta ? meta.getAttribute('content') : '';
  };

  // Conferme per azioni pericolose
  document.addEventListener('click', function(e){
    const el = e.target.closest('[data-confirm]');
    if(el){
      const msg = el.getAttribute('data-confirm') || 'Sei sicuro?';
      if(!confirm(msg)){
        e.preventDefault();
      }
    }
  });

  // Filtro tabellare semplice client-side
  window.attachQuickFilter = function(inputSelector, tableSelector){
    const input = document.querySelector(inputSelector);
    const table = document.querySelector(tableSelector);
    if(!input || !table) return;
    input.addEventListener('input', function(){
      const q = input.value.toLowerCase();
      table.querySelectorAll('tbody tr').forEach(tr=>{
        const t = tr.innerText.toLowerCase();
        tr.style.display = t.includes(q) ? '' : 'none';
      });
    });
  };
})();